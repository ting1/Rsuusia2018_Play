var __reflect=this&&this.__reflect||function(e,t,a){e.__class__=t,a?a.push(t):a=[t],e.__types__=e.__types__?a.concat(e.__types__):a},__extends=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);a.prototype=t.prototype,e.prototype=new a},__awaiter=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(o,i){function s(e){try{h(n.next(e))}catch(t){i(t)}}function r(e){try{h(n["throw"](e))}catch(t){i(t)}}function h(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(s,r)}h((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function a(e){return function(t){return n([e,t])}}function n(a){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,i&&(s=i[2&a[0]?"return":a[0]?"throw":"next"])&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[0,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return h.label++,{value:a[1],done:!1};case 5:h.label++,i=a[1],a=[0];continue;case 7:a=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===a[0]||2===a[0])){h=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){h.label=a[1];break}if(6===a[0]&&h.label<s[1]){h.label=s[1],s=a;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(a);break}s[2]&&h.ops.pop(),h.trys.pop();continue}a=t.call(e,h)}catch(n){a=[6,n],i=0}finally{o=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var o,i,s,r,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),"throw":a(1),"return":a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},BaseChunk=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.Component);__reflect(BaseChunk.prototype,"BaseChunk");var LevelGroup=function(e){function t(){var t=e.call(this)||this;return t.groupname=["简单","困难"],t.skinName="resource/skins/levelgroup.exml",t.x=(GameData.stageW-t.width)/2,t.y=200,t.createLvButton(),t}return __extends(t,e),t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.createLvButton=function(){for(var e=0;e<GameData.chunkGroupMap.length;e++){var t=new LevelButton;t.btn_num_level.text=e+1+"";var a=GameData.getItemLevel(e+1);"1"==a?(t.btn_tt.visible=!0,t.touchEnabled=!0,t.btn_lock.visible=!1):(t.touchEnabled=!1,t.btn_lock.visible=!0),this.lv_group.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)}},t.prototype.onClose=function(){this.removeChildren()},t.prototype.onBtnTap=function(e){var t=e.currentTarget;console.log();var a=t.btn_num_level.text;GameData.curLevelNum=a,GameData.setCurLevel(a),CreateGame.getInstance().initData(a),CreateGame.getInstance().Cur(a),this.removeChildren()},t._instance=null,t}(eui.Component);__reflect(LevelGroup.prototype,"LevelGroup");var ChunkType;!function(e){e[e.None=0]="None",e[e.Chunk1=1]="Chunk1",e[e.Chunk2=2]="Chunk2",e[e.Chunk3=3]="Chunk3",e[e.Chunk4=4]="Chunk4",e[e.Chunk5=5]="Chunk5",e[e.Chunk6=6]="Chunk6"}(ChunkType||(ChunkType={}));var Chunk=function(e){function t(t,a){var n=e.call(this)||this;return n.chunkTempX=0,n.chunkTempY=0,n.chunkInitX=0,n.chunkInitY=0,n.stageSize={col:4,row:4,boxsize:70},n.chunkMap=new Array,n.chunkChooseMap=new Array,n.weiZhiX=0,n.weiZhiY=0,n.chunkCurLevelNum=a,n.ChunkType=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"ChunkType",{get:function(){return this._ChunkType},set:function(e){this._ChunkType=e,this.showChunk(e)},enumerable:!0,configurable:!0}),t.prototype.flipUpDown=function(){for(var e,t=(new Array,0);2>t;t++)for(var a=0;4>a;a++)e=this.chunkMap[t][a],this.chunkMap[t][a]=this.chunkMap[4-t-1][a],this.chunkMap[4-t-1][a]=e;this.removeChildren(),this.showStage()},t.prototype.chunkFlipUp=function(){for(var e=new Array,t=0;t<this.chunkMap.length;t++)e[t]=new Array,e[t][0]=this.chunkMap[t][0],e[t][1]=this.chunkMap[t][1],t>0&&(this.chunkMap[t][0]=e[t][0],this.chunkMap[t][1]=-e[t][1]);this.chunkMap[this.chunkMap.length-1][1]<0&&(this.chunkTempX=Math.abs(this.chunkMap[this.chunkMap.length-1][1])),this.chunkMap[this.chunkMap.length-1][0]<0&&(this.chunkTempY=Math.abs(this.chunkMap[this.chunkMap.length-1][0])),this.removeChildren(),this.drawChunk(this.chunkMap)},t.prototype.chunkChage=function(){for(var e=new Array,t=0;t<this.chunkMap.length;t++)e[t]=new Array,e[t][0]=this.chunkMap[t][0],e[t][1]=this.chunkMap[t][1],t>0&&(this.chunkMap[t][0]=e[t][1],this.chunkMap[t][1]=-e[t][0]);this.chunkMap[this.chunkMap.length-1][1]<0&&(this.chunkTempX=Math.abs(this.chunkMap[this.chunkMap.length-1][1])),this.chunkMap[this.chunkMap.length-1][0]<0&&(this.chunkTempY=Math.abs(this.chunkMap[this.chunkMap.length-1][0])),console.log("chunkChage"+this.chunkMap),this.removeChildren(),this.drawChunk(this.chunkMap)},t.prototype.change=function(){for(var e=new Array,t=3,a=0;4>a;a++){e[a]=new Array;for(var n=0;4>n;n++)e[a][n]=this.chunkMap[a][n]}for(var a=0;4>a;a++){for(var n=0;4>n;n++)this.chunkMap[a][n]=e[t][a],t--;t=3}this.removeChildren(),this.drawChunk(this.chunkMap),console.log("子元素："+this.numChildren)},t.prototype.showStage=function(){for(var e=0;e<this.stageSize.row;e++)for(var t=0;t<this.stageSize.col;t++)this.shape=new egret.Shape,0==this.chunkMap[e][t]?(this.shape.graphics.beginFill(12434877),this.shape.graphics.drawRect(t*this.stageSize.boxsize,e*this.stageSize.boxsize,this.stageSize.boxsize,this.stageSize.boxsize),this.shape.graphics.endFill(),this.shape.alpha=1):(1==this.chunkMap[e][t]||2==this.chunkMap[e][t])&&(1==this.ChunkType,this.shape.graphics.lineStyle(1,12434877),this.shape.graphics.beginFill(GameData.chunkbg[this.ChunkType]),this.shape.graphics.drawRect(t*this.stageSize.boxsize,e*this.stageSize.boxsize,this.stageSize.boxsize,this.stageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape))},t.prototype.showChunk=function(e){var t=this.initChunk(e);this.chunkMap=t,this.chunkMap[this.chunkMap.length-1][1]<0&&(this.chunkTempX=Math.abs(this.chunkMap[this.chunkMap.length-1][1])),this.chunkMap[this.chunkMap.length-1][0]<0&&(this.chunkTempY=Math.abs(this.chunkMap[this.chunkMap.length-1][0])),this.drawChunk(this.chunkMap)},t.prototype.drawChunk=function(e){for(var t=0;t<e.length;t++){var a=new ChunkOne(this.ChunkType);a.x=e[t][1]*GameData.stageBoxSize,a.y=e[t][0]*GameData.stageBoxSize,this.addChild(a)}},t.prototype.initChunk=function(e){return GameData.chunkGroupMap[this.chunkCurLevelNum][e-1]},t.prototype.initSeven=function(e){var t=new Array;switch(e){case 1:t=[[0,0,1,1],[1,1,1,0],[0,0,0,0],[0,0,0,0]];break;case 2:t=[[1,0,0,0],[1,0,0,0],[1,1,1,0],[0,0,0,0]];break;case 3:t=[[1,0,0,0],[1,1,0,0],[1,1,0,0],[0,0,0,0]];break;case 4:t=[[0,1,1,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]];break;case 5:t=[[1,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]];break;case 6:t=[[1,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]];break;case 7:t=[[0,0,1,0],[0,1,1,1],[0,0,1,0],[0,0,0,0]];break;case 8:t=[[1,1,1,1],[0,0,1,0],[0,0,0,0],[0,0,0,0]];break;case 9:t=[[1,1,1,1],[0,0,0,1],[0,0,0,0],[0,0,0,0]]}return t},t.prototype.showButton=function(e){for(var t=this.initSeven(e),a=0;a<this.stageSize.row;a++)for(var n=0;n<this.stageSize.col;n++)this.chunkMap[a][n]=t[a][n];this.showStage()},t}(BaseChunk);__reflect(Chunk.prototype,"Chunk");var ChunkOne=function(e){function t(t){var a=e.call(this)||this,n="color_"+t+"_png";return a.source=RES.getRes(n),a}return __extends(t,e),Object.defineProperty(t.prototype,"IsSelected",{get:function(){return this._IsSelected},set:function(e){this._IsSelected=e,e?this.alpha=.5:this.alpha=1},enumerable:!0,configurable:!0}),t}(eui.Image);__reflect(ChunkOne.prototype,"ChunkOne");var CreateGame=function(e){function t(){var t=e.call(this)||this;return t.moveChunk=null,t.chooseChunk=null,t.startTap=!0,t.gameMapOffsetX=10,t.gameMapOffsetY=150,t.gameChunkOffsetX=20,t.gameChunkOffsetY=550,t.chunkinitScale=.7,t.chunkupScale=1,t.stageSize={col:20,row:20,boxsize:60},t.buttomStageSize={col:9,row:5,boxsize:60,buttomX:20,buttomHeight:300},t.skinName="resource/skins/gamestage.exml",t.initGame(),t.initAd(),t}return __extends(t,e),t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.initAd=function(){},t.prototype.initGame=function(){GameData.curLevelNum=GameData.getCurLevel(),this.initData(GameData.curLevelNum),this.initEvent(),this.Cur(GameData.curLevelNum)},t.prototype.initEvent=function(){this.btn_rol.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onlabel_tap_rot,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBack,this),this.btn_fillup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onlabel_tap,this),this.btn_choose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChoose,this),this.btn_tip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTip,this)},t.prototype.onTip=function(){if(1==GameData.gameType)return void(this.btn_tip.touchEnabled=!1);this.chunkTopOne=this.chunkGroup[0],console.log(this.chunkTopOne.chunkMap);var e=GameData.chunkGroupTipMap[GameData.curLevelNum-1];this.chunkTopOne.removeChildren(),this.chunkTopOne.drawChunk(e),GameData.cleanData(this.chunkTopOne.ChunkType),this.chunkTopOne.x=GameData.chunkGroupTipxy[GameData.curLevelNum-1][0],this.chunkTopOne.y=GameData.chunkGroupTipxy[GameData.curLevelNum-1][1];for(var t=this.chunkTopOne.x+this.gameChunkOffsetX-this.gameMapOffsetX,a=this.chunkTopOne.y+this.gameChunkOffsetY-this.gameMapOffsetY,n={x:t,y:a},o=this.getTouchPoint(n),i=o[1],s=o[0],r=0;r<e.length;r++){var h=i+e[r][0],u=s+e[r][1];if(0>h||0>u)return;h<GameData.stageRow&&u<GameData.stageCol&&0==GameData.mapData[h][u]&&(GameData.mapData[h][u]=this.chunkTopOne.ChunkType,this.chunkTopOne.alpha=1,this.chunkTopOne.scaleX=this.chunkTopOne.scaleY=this.chunkupScale,this.chunkTopOne.y=this.chunkTopOne.y-(this.chunkTopOne.y+this.gameChunkOffsetY-this.gameMapOffsetY-i*GameData.stageBoxSize),this.chunkTopOne.x=this.chunkTopOne.x-(this.chunkTopOne.x+this.gameChunkOffsetX-this.gameMapOffsetX-s*GameData.stageBoxSize))}FBInstant.getRewardedVideoAsync("331942580906618_358676158233260").then(function(e){return this.preloadedRewardedVideo=e,this.preloadedRewardedVideo.loadAsync()}).then(function(){console.log("Rewarded video preloaded")})["catch"](function(e){console.error("Rewarded video failed to preload: "+e.message)}),null!=this.preloadedRewardedVideo&&this.preloadedRewardedVideo.showAsync().then(function(){console.log("Rewarded video watched successfully")})["catch"](function(e){console.error(e.message)})},t.prototype.onBack=function(){this.parent.addChild(new StartGame),this.parent.removeChild(this)},t.prototype.getTouchPoint=function(e){var t=new Array;return t[0]=Math.round(e.x/GameData.stageBoxSize),t[1]=Math.round(e.y/GameData.stageBoxSize),t},t.prototype.initData=function(e){GameData.initData(),this.gameMapOffsetX=(GameData.stageW-GameData.stageCol*GameData.stageBoxSize)/2,console.log("xxxx"+GameData.stageW/2),null!=this.GameChunkGroup&&this.removeChild(this.GameChunkGroup),null!=this.GameMapGroup&&this.removeChild(this.GameMapGroup),this.GameChunkGroup=new egret.Sprite,this.GameChunkGroup.y=this.gameChunkOffsetY,this.GameChunkGroup.x=this.gameChunkOffsetX,this.GameMapGroup=new egret.Sprite,this.GameMapGroup.y=this.gameMapOffsetY,this.GameMapGroup.x=this.gameMapOffsetX,this.GameMapGroup.graphics.drawRect(0,0,GameData.stageCol*GameData.stageBoxSize,GameData.stageRow*GameData.stageBoxSize),this.GameMapGroup.graphics.endFill(),this.addChild(this.GameMapGroup),this.begin(e-1)},t.prototype.Cur=function(e){this.ll_level.text="Level "+e},t.prototype.begin=function(e){this.showGameStage(),null!=this.chunkGroup&&(this.chunkGroup=null),this.chunkGroup=new Array;for(var t=1;t<GameData.chunkGroupMap[e].length+1;t++){var a=new Chunk(t,e);a.scaleX=a.scaleY=this.chunkinitScale,a.alpha=1;var n=a.y;t>5?(a.x=120*(t-6),a.y=n+200):(a.x=120*(t-1),a.y=n),a.chunkInitX=a.x,a.chunkInitY=a.y,this.chunkGroup.push(a),this.GameChunkGroup.addChild(a),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.ontouch_begin,this),a.addEventListener(egret.TouchEvent.TOUCH_END,this.ontouch_end,this)}this.addChild(this.GameChunkGroup)},t.prototype.onChoose=function(){var e=new LevelGroup;this.addChild(e)},t.prototype.onTopMode=function(){GameData.stageCol=9,GameData.stageRow=5,this.initData(5)},t.prototype.onNext=function(){console.log("a"+GameData.curLevelNum),GameData.curLevelNum<GameData.chunkGroupMap.length&&(console.log("a"+GameData.curLevelNum),GameData.curLevelNum++,this.initData(GameData.curLevelNum),this.Cur(GameData.curLevelNum))},t.prototype.onInit=function(){this.initData(0)},t.prototype.onDone=function(){GameData.GameDone()&&this.addChild(new PopupButton)},t.prototype.onlabel_tap=function(){console.log("点击"),null!=this.chooseChunk&&(this.chooseChunk.chunkFlipUp(),GameData.cleanData(this.chooseChunk.ChunkType),this.chooseChunk.alpha=1)},t.prototype.onlabel_tap_rot=function(){console.log("点击"),null!=this.chooseChunk&&(this.chooseChunk.chunkChage(),GameData.cleanData(this.chooseChunk.ChunkType),this.chooseChunk.alpha=1)},t.prototype.ontouch_begin=function(e){this.offsetX=0,this.offsetY=0,this.startTap=!1;var t=e.currentTarget;t.scaleX=t.scaleY=this.chunkupScale,this.begigTapX=t.x,this.begigTapY=t.y;var a={x:e.localX,y:e.localY},n=this.getTouchPoint(a);this.begigTapPorinCol=n[0],this.begigTapPorinRow=n[1],this.isflipUp=!0;var t=e.currentTarget;this.moveChunk=t,this.chooseChunk=t,this.offsetX=e.stageX-t.x-this.gameChunkOffsetX,this.offsetY=e.stageY-t.y-this.gameChunkOffsetY,GameData.cleanData(t.ChunkType),t.alpha=1,this.GameChunkGroup.setChildIndex(t,this.GameChunkGroup.numChildren-1),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)},t.prototype.stopMove=function(e){this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)},t.prototype.onMove=function(e){e.currentTarget;this.moveChunk.x=e.stageX-this.offsetX-this.gameChunkOffsetX,this.moveChunk.y=e.stageY-this.offsetY-this.gameChunkOffsetY},t.prototype.ontouch_move=function(e){var t=e.currentTarget;if(this.moveChunk.ChunkType==t.ChunkType){if(t.x=e.stageX-this.offsetX-this.gameChunkOffsetX,t.y=e.stageY-this.offsetY-this.gameChunkOffsetY,t.y<0-this.gameChunkOffsetY+this.gameMapOffsetY)return void(t.y=0-this.gameChunkOffsetY+this.gameMapOffsetY);if(t.x<0+t.chunkTempX*GameData.stageBoxSize)return void(t.x=t.chunkTempX*GameData.stageBoxSize);if(t.x>GameData.stageW+t.chunkTempX*GameData.stageBoxSize-t.width)return void(t.x=GameData.stageW+t.chunkTempX*GameData.stageBoxSize-t.width)}},t.prototype.ontouch_end=function(e){this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this);var t=e.currentTarget,a=t.x+this.gameChunkOffsetX-this.gameMapOffsetX,n=t.y+this.gameChunkOffsetY-this.gameMapOffsetY,o={x:a,y:n};console.log("ret x: "+t.x+"reg y:"+t.y);var i=this.getTouchPoint(o);if(this.endTapPorinRow=i[1],this.endTapPorinCol=i[0],this.endTapPorinRow<0||this.endTapPorinCol<0)return t.scaleX=t.scaleY=this.chunkinitScale,void(t.alpha=.8);if(this.endTapPorinRow>=GameData.stageRow||this.endTapPorinCol>=GameData.stageCol)return t.scaleX=t.scaleY=this.chunkinitScale,void(t.alpha=.8);if(0==GameData.mapData[this.endTapPorinRow][this.endTapPorinCol]){for(var s=0;s<t.chunkMap.length;s++){var r=this.endTapPorinRow+t.chunkMap[s][0],h=this.endTapPorinCol+t.chunkMap[s][1];if(0>r||0>h||r>GameData.stageRow-1||h>GameData.stageCol-1)return;if(r<GameData.stageRow&&h<GameData.stageCol&&0!=GameData.mapData[r][h])return}for(var s=0;s<t.chunkMap.length;s++){var r=this.endTapPorinRow+t.chunkMap[s][0],h=this.endTapPorinCol+t.chunkMap[s][1];r<GameData.stageRow&&h<GameData.stageCol&&0==GameData.mapData[r][h]&&(GameData.mapData[r][h]=t.ChunkType,t.alpha=1,t.scaleX=t.scaleY=this.chunkupScale,t.y=t.y-(t.y+this.gameChunkOffsetY-this.gameMapOffsetY-this.endTapPorinRow*GameData.stageBoxSize),t.x=t.x-(t.x+this.gameChunkOffsetX-this.gameMapOffsetX-this.endTapPorinCol*GameData.stageBoxSize))}this.onDone()}},t.prototype.showGameStage=function(){for(var e=0;e<GameData.stageRow;e++)for(var t=0;t<GameData.stageCol;t++)if(this.shape=new egret.Shape,0==GameData.mapData[e][t]){var a=new ChunkOne(0);a.x=t*GameData.stageBoxSize+GameData.boxButtomX,a.y=e*GameData.stageBoxSize+GameData.boxButtomY,this.GameMapGroup.addChild(a)}},t.prototype.showStage=function(){for(var e=0;e<this.stageSize.row;e++)for(var t=0;t<this.stageSize.col;t++)this.shape=new egret.Shape,0==this.erwei[e][t]?(this.shape.graphics.beginFill(13684944),this.shape.graphics.drawRect(t*this.stageSize.boxsize,e*this.stageSize.boxsize,this.stageSize.boxsize,this.stageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape)):(1==this.erwei[e][t]||2==this.erwei[e][t])&&(this.shape.graphics.beginFill(14423100),this.shape.graphics.drawRect(t*this.stageSize.boxsize,e*this.stageSize.boxsize,this.stageSize.boxsize,this.stageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape))},t._instance=null,t}(eui.Component);__reflect(CreateGame.prototype,"CreateGame");var GameData=function(){function e(){}return e.initData=function(){this.chunkbg=[10494192,15597806,15658496,10494192,15608876,15636992,13445520,13639824,16766720,13481421],e.stageW=egret.MainContext.instance.stage.stageWidth,e.stageH=egret.MainContext.instance.stage.stageHeight,e.mapData=new Array;for(var t=0;t<e.stageRow;t++){e.mapData[t]=new Array;for(var a=0;a<e.stageCol;a++)e.mapData[t][a]=0}},e.GameDone=function(){for(var t=0;t<e.stageRow;t++)for(var a=0;a<e.stageCol;a++)if(0==e.mapData[t][a])return!1;return!0},e.cleanData=function(t){for(var a=0;a<e.stageRow;a++)for(var n=0;n<e.stageCol;n++)e.mapData[a][n]==t&&(e.mapData[a][n]=0)},e.cleanAllData=function(){for(var t=0;t<e.stageRow;t++)for(var a=0;a<e.stageCol;a++)e.mapData[t][a]=0},e.getCurLevel=function(){var t=Number(egret.localStorage.getItem("curLevelNum_"+e.gameType));return 0==t&&(t=1),t},e.setCurLevel=function(t){egret.localStorage.setItem("curLevelNum_"+e.gameType,t)},e.getItemLevel=function(t){var a=egret.localStorage.getItem("item_"+e.gameType+"_"+t);return a},e.setItemLevel=function(t,a){egret.localStorage.setItem("item_"+e.gameType+"_"+t,a)},e.chunkTempW=0,e.chunkTempH=500,e.gameType=0,e.stageBoxSize=60,e.stageBoxColor=12434877,e.boxButtomX=0,e.boxButtomY=0,e.curLevelNum=0,e.chunkTypeNum=2,e.stageW=0,e.stageH=0,e}();__reflect(GameData.prototype,"GameData");var GameDataParse=function(){function e(){}return e.createGameData=function(e){var t=e.chunkGroupMap.length;GameData.chunkGroupMap=new Array;for(var a=0;t>a;a++)egret.localStorage.setItem("item_"+a+1,"0"),GameData.chunkGroupMap.push(e.chunkGroupMap[a]);var n=e.chunkGroupTipMap.length;GameData.chunkGroupTipMap=new Array,GameData.chunkGroupTipxy=new Array;for(var a=0;n>a;a++)GameData.chunkGroupTipxy.push(e.chunkGroupTipxy[a]),GameData.chunkGroupTipMap.push(e.chunkGroupTipMap[a]);GameData.stageCol=e.stageCol,GameData.stageRow=e.stageRow},e}();__reflect(GameDataParse.prototype,"GameDataParse");var LeaderItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/leaderitem.exml",t}return __extends(t,e),t}(eui.ItemRenderer);__reflect(LeaderItem.prototype,"LeaderItem");var LevelButton=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/levelItem.exml",t}return __extends(t,e),t}(eui.Button);__reflect(LevelButton.prototype,"LevelButton");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,a){function n(n){t.call(a,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LevelLeader=function(e){function t(){var t=e.call(this)||this;return t.dataArray=new eui.ArrayCollection,t.skinName="resource/skins/levelleader.exml",t.x=(640-t.width)/2,t.y=100,t.createLvButton(),t}return __extends(t,e),t.getInstance=function(){return null==t._instance&&(t._instance=new LevelGroup),t._instance},t.prototype.createLvButton=function(){this.datalist.dataProvider=this.dataArray,this.datalist.itemRenderer=LeaderItem,this.dataArray.replaceAll(t.tempArray),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.testpopulateLeaderboard=function(){this.tempArray.push({index:"2",msg:"等级",score:"3",status:0})},t.populateLeaderboard=function(e){var t=this;this.tempArray=null,this.tempArray=new Array,e.forEach(function(e){t.tempArray.push({index:e.getRank(),msg:"等级",score:e.getScore(),status:0})})},t.prototype.initData=function(){for(var e=[],t=0;40>t;t++)e.push({index:t,msg:t+"等级",score:"0",status:0});return e},t.prototype.onClose=function(){this.removeChildren()},t._instance=null,t}(eui.Component);__reflect(LevelLeader.prototype,"LevelLeader");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.onProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){this.addChild(new StartGame)},t.prototype.initializeAsync=function(){FBInstant.initializeAsync().then(function(){egret.log("getLocale:",FBInstant.getLocale()),egret.log("getPlatform:",FBInstant.getPlatform()),egret.log("getSDKVersion",FBInstant.getSDKVersion()),egret.log("getSupportedAPIs",FBInstant.getSupportedAPIs()),egret.log("getEntryPointData",FBInstant.getEntryPointData())})},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var PopupButton=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/popup.exml",t.init(),t.x=(GameData.stageW-t.width)/2,t.y=300,t.btn_comple.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onComple,t),t}return __extends(t,e),t.prototype.onComple=function(){GameData.GameDone()?(FBInstant.getLeaderboardAsync("levels").then(function(e){return console.log(e.getName()),e.setScoreAsync(GameData.curLevelNum,"1111")}).then(function(){return console.log("Score saved")})["catch"](function(e){return console.error(e)}),this.lb_text.text="Victory! You can go to the next level",this.parent.removeChild(this),CreateGame.getInstance().onNext()):(this.lb_text.text="很遗憾！请继续游戏",this.btn_comple.label="关闭",this.parent.removeChild(this))},t.prototype.init=function(){GameData.GameDone()?(GameData.setCurLevel(GameData.curLevelNum+1+""),GameData.setItemLevel(GameData.curLevelNum,"1"),this.lb_text.text="Victory! You can go to the next level"):(this.lb_text.text="很遗憾！请继续游戏",this.btn_comple.label="关闭")},t}(eui.Component);__reflect(PopupButton.prototype,"PopupButton");var PopupFailButton=function(){function e(){}return e}();__reflect(PopupFailButton.prototype,"PopupFailButton");var StartGame=function(e){function t(){var t=e.call(this)||this;return t.preloadedInterstitial=null,t.skinName="resource/skins/startgame.exml",t.btn_easy.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onEGame,t),t.btn_diff.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onDGame,t),t.btn_leader.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onLeader,t),t.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onShare,t),t}return __extends(t,e),t.prototype.onShare=function(){var e=new Image;e.src="resource/res/bg2.png",e.onload=function(){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var a=t.getContext("2d");a.drawImage(e,0,0,e.width,e.height);var n=e.src.substring(e.src.lastIndexOf(".")+1).toLowerCase(),o=t.toDataURL("image/"+n);FBInstant.shareAsync({intent:"REQUEST",image:o,text:"Hey I'm stuck on this puzzle! Can you help me?",data:{myReplayData:"..."}}),console.log(o)}},t.prototype.onEGame=function(){var e=RES.getRes("l1_json");GameDataParse.createGameData(e),GameData.gameType=0,this.parent.addChild(CreateGame.getInstance()),this.parent.removeChild(this),CreateGame.getInstance().initGame()},t.prototype.onLeader=function(){this.addChild(new LevelLeader)},t.prototype.onDGame=function(){var e=RES.getRes("l2_json");GameDataParse.createGameData(e),GameData.gameType=1,this.parent.addChild(CreateGame.getInstance()),this.parent.removeChild(this),CreateGame.getInstance().initGame()},t.prototype.initAd=function(){FBInstant.getInterstitialAdAsync("331942580906618_331997437567799").then(function(e){return this.preloadedInterstitial=e,this.preloadedInterstitial.loadAsync()}).then(function(){console.log("Interstitial preloaded")})["catch"](function(e){console.error("Interstitial failed to preload: "+e.message)}),null!=this.preloadedInterstitial&&this.preloadedInterstitial.showAsync().then(function(){console.log("Interstitial ad finished successfully")})["catch"](function(e){console.error(e.message)})},t}(eui.Component);__reflect(StartGame.prototype,"StartGame");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,a,n){function o(e){t.call(n,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),a.call(n))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,a){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);