var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))(function(n,r){function s(e){try{a(o.next(e))}catch(t){r(t)}}function h(e){try{a(o["throw"](e))}catch(t){r(t)}}function a(e){e.done?n(e.value):new i(function(t){t(e.value)}).then(s,h)}a((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return o([e,t])}}function o(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(6===i[0]&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(o){i=[6,o],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,r,s,h,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return h={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},BaseChunk=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(egret.Sprite);__reflect(BaseChunk.prototype,"BaseChunk");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function o(o){t.call(i,o,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?o(n):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ChunkType;!function(e){e[e.None=0]="None",e[e.Chunk1=1]="Chunk1",e[e.Chunk2=2]="Chunk2",e[e.Chunk3=3]="Chunk3",e[e.Chunk4=4]="Chunk4",e[e.Chunk5=5]="Chunk5"}(ChunkType||(ChunkType={}));var Chunk=function(e){function t(t){var i=e.call(this)||this;i.stageSize={col:4,row:4,boxsize:60},i.chunkbg=[15597806,15597806,15658496,10494192,15608876,15636992,13445520,13639824,16766720,13481421],i.weiZhiX=0,i.weiZhiY=0,i.chunkMap=new Array,i.chunkShape=new Array;for(var o=0;o<i.stageSize.row;o++){i.chunkMap[o]=new Array;for(var n=0;n<i.stageSize.col;n++)i.chunkMap[o][n]=0}return i.ChunkType=t,i}return __extends(t,e),Object.defineProperty(t.prototype,"ChunkType",{get:function(){return this._ChunkType},set:function(e){this._ChunkType=e,this.showButton(e)},enumerable:!0,configurable:!0}),t.prototype.flipUpDown=function(){for(var e,t=(new Array,0);2>t;t++)for(var i=0;4>i;i++)e=this.chunkMap[t][i],this.chunkMap[t][i]=this.chunkMap[4-t-1][i],this.chunkMap[4-t-1][i]=e;this.removeChildren(),this.showStage()},t.prototype.change=function(){for(var e=new Array,t=3,i=0;4>i;i++){e[i]=new Array;for(var o=0;4>o;o++)e[i][o]=this.chunkMap[i][o]}for(var i=0;4>i;i++){for(var o=0;4>o;o++)this.chunkMap[i][o]=e[t][i],t--;t=3}this.removeChildren(),console.log("子元素："+this.numChildren),this.showStage()},t.prototype.showStage=function(){for(var e=0;e<this.stageSize.row;e++)for(var t=0;t<this.stageSize.col;t++)this.shape=new egret.Shape,0==this.chunkMap[e][t]||(1==this.chunkMap[e][t]||2==this.chunkMap[e][t])&&(1==this.ChunkType,this.shape.graphics.lineStyle(1,12434877),this.shape.graphics.beginFill(this.chunkbg[this.ChunkType]),this.shape.graphics.drawRect(t*this.stageSize.boxsize,e*this.stageSize.boxsize,this.stageSize.boxsize,this.stageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape))},t.prototype.initSeven=function(e){var t=new Array;switch(e){case 1:t=[[0,0,1,1],[1,1,1,0],[0,0,0,0],[0,0,0,0]];break;case 2:t=[[1,0,0,0],[1,0,0,0],[1,1,1,0],[0,0,0,0]];break;case 3:t=[[1,0,0,0],[1,1,0,0],[1,1,0,0],[0,0,0,0]];break;case 4:t=[[0,1,1,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]];break;case 5:t=[[1,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]];break;case 6:t=[[1,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]];break;case 7:t=[[0,0,1,0],[0,1,1,1],[0,0,1,0],[0,0,0,0]];break;case 8:t=[[1,1,1,1],[0,0,1,0],[0,0,0,0],[0,0,0,0]];break;case 9:t=[[1,1,1,1],[0,0,0,1],[0,0,0,0],[0,0,0,0]]}return t},t.prototype.showButton=function(e){for(var t=this.initSeven(e),i=0;i<this.stageSize.row;i++)for(var o=0;o<this.stageSize.col;o++)this.chunkMap[i][o]=t[i][o];this.showStage()},t}(BaseChunk);__reflect(Chunk.prototype,"Chunk");var CreateGame=function(e){function t(){var t=e.call(this)||this;t.moveChunk=null,t.chooseChunk=null,t.stageSize={col:20,row:20,boxsize:60},t.buttomStageSize={col:9,row:5,boxsize:60,buttomX:20,buttomHeight:300},t.chunkGroup=new Array,t.erwei=new Array;for(var i=0;i<t.stageSize.row;i++){t.erwei[i]=new Array;for(var o=0;o<t.stageSize.col;o++)t.erwei[i][o]=0}t.brwei=new Array;for(var i=0;i<t.buttomStageSize.row;i++){t.brwei[i]=new Array;for(var o=0;o<t.buttomStageSize.col;o++)t.brwei[i][o]=0}return t.begin(),t}return __extends(t,e),t.prototype.begin=function(){this.showStage(),this.showButtomStage();for(var e=0;9>e;e++)this.addChild(this.chunkone=new Chunk(e+1)),this.chunkGroup.push(this.chunkone);console.log(this.chunkGroup.length),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.ontouch_begin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.ontouch_move,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.ontouch_end,this);var t=new egret.TextField;t.touchEnabled=!0,t.text="点击翻转",this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onlabel_tap,this);var t=new egret.TextField;t.touchEnabled=!0,t.text="点击旋转",t.x=200,this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onlabel_tap_rot,this)},t.prototype.onlabel_tap=function(){console.log("点击"),null!=this.moveChunk&&this.moveChunk.flipUpDown()},t.prototype.onlabel_tap_rot=function(){console.log("点击"),null!=this.moveChunk&&this.moveChunk.change()},t.prototype.ontouch_begin=function(e){this.isflipUp=!0,this.longtime=egret.getTimer();for(var t=new egret.Point(e.stageX,e.stageY),i=this.chunkGroup.length-1;i>=0;i--){var o=this.chunkGroup[i],n=new egret.Rectangle(o.x,o.y,o.width,o.height);n.containsPoint(t)&&(this.moveChunk=o,this.offsetX=e.stageX-this.moveChunk.x,this.offsetY=e.stageY-this.moveChunk.y)}},t.prototype.onMove=function(e){this.draggedObject.x=e.stageX-this.offsetX,this.draggedObject.y=e.stageY-this.offsetY},t.prototype.ontouch_move=function(e){null!=this.moveChunk&&(this.moveChunk.x=e.stageX-this.offsetX,this.moveChunk.y=e.stageY-this.offsetY)},t.prototype.ontouch_end=function(e){},t.prototype.showButtomStage=function(){for(var e=0;e<this.buttomStageSize.row;e++)for(var t=0;t<this.buttomStageSize.col;t++)this.shape=new egret.Shape,0==this.brwei[e][t]?(this.shape.graphics.lineStyle(1,12434877),this.shape.graphics.beginFill(10145074),this.shape.graphics.drawRect(t*this.buttomStageSize.boxsize+this.buttomStageSize.buttomX,e*this.buttomStageSize.boxsize+this.buttomStageSize.buttomHeight,this.buttomStageSize.boxsize,this.buttomStageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape)):(1==this.brwei[e][t]||2==this.brwei[e][t])&&(this.shape.graphics.beginFill(14423100),this.shape.graphics.drawRect(t*this.buttomStageSize.boxsize+this.buttomStageSize.buttomX,e*this.buttomStageSize.boxsize+this.buttomStageSize.buttomHeight,this.buttomStageSize.boxsize,this.buttomStageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape))},t.prototype.showStage=function(){for(var e=0;e<this.stageSize.row;e++)for(var t=0;t<this.stageSize.col;t++)this.shape=new egret.Shape,0==this.erwei[e][t]?(this.shape.graphics.beginFill(13684944),this.shape.graphics.drawRect(t*this.stageSize.boxsize,e*this.stageSize.boxsize,this.stageSize.boxsize,this.stageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape)):(1==this.erwei[e][t]||2==this.erwei[e][t])&&(this.shape.graphics.beginFill(14423100),this.shape.graphics.drawRect(t*this.stageSize.boxsize,e*this.stageSize.boxsize,this.stageSize.boxsize,this.stageSize.boxsize),this.shape.graphics.endFill(),this.addChild(this.shape))},t}(egret.Sprite);__reflect(CreateGame.prototype,"CreateGame");var GameData=function(){function e(){}return e}();__reflect(GameData.prototype,"GameData");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.drawText=function(){this.txt=new egret.TextField,this.txt.size=12,this.txt.x=250,this.txt.width=200,this.txt.height=200,this.txt.text="事件文字",this.addChild(this.txt)},t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.onProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.createGameScene=function(){this.drawText();var e=new CreateGame;this.addChild(e)},t.prototype.onTouch=function(e){this.txt.text+="\n点击了spr1"},t.prototype.ontouch_begin=function(e){},t.prototype.ontouch_move=function(e){this.chunkone.x=e.stageX,this.chunkone.y=e.stageY},t.prototype.ontouch_end=function(e){},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,o){function n(e){t.call(o,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(o))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(o,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,i){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(o,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);